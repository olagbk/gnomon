<div class="container px-md-5">

  <div class="tags dark-container p-4 mt-1">
    <a class="small-link" *ngIf="activeTags.length > 0" (click)="deleteAllTags()">[ reset ]</a>
    <app-tags [tags]="activeTags"
              [count]="true"
              [selected]="true"
              (tagSelected)="deleteTag($event)">

    </app-tags>
    <app-tags [tags]="inactiveTags"
              [count]="true"
              [abbr]="!tagsExpanded"
              (tagSelected)="addTag($event)"
              (tagsExpanded)="tagsExpanded = true">
    </app-tags>
    <a class="small-link" *ngIf="!tagsExpanded" (click)="tagsExpanded = true">more...</a>


    <span class="tags-opts" *ngIf="activeTags?.length > 1">
      <a class="link"
         [class.active]="!tagsAllMode"
         (click)="toggleTagMode()">any
      </a> /
      <a class="link"
         [class.active]="tagsAllMode"
         (click)="toggleTagMode()">all
      </a>
    </span>

    <ng-container *ngIf="tagsExpanded">

      <input #search
             [(ngModel)]="searchedTag"
             [typeahead]="inactiveTags"
             typeaheadOptionField="name"
             typeaheadScrollable = true
             (typeaheadOnSelect)="addSearchedTag($event)"
             class="form-control tag-search">

      <a class="small-link"
         (click)="tagsExpanded = false">[ hide ]
      </a>

    </ng-container>

  </div>

  <div class="dark-container post my-4" *ngFor="let post of filteredPosts | async">

    <a class="link title mb-2" [routerLink]="post.id">{{ post.title }}</a>

    <span class="created-at">{{post.createdAt | date }}</span>

    <app-tags [tags]="post.tags"
              (tagSelected)="addTag($event)">
    </app-tags>

    <p class="text pl-md-3 mt-2"
       ellipsis="(...)"
       [ellipsis-word-boundaries]="' \n'"
       (ellipsis-click-more)="goToPost(post.id)">{{post.body}}
    </p>

    <div class="shadow-wrapper"></div>
  </div>
</div>
<app-scroll></app-scroll>
